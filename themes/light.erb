<html>
  <head>
  <style>
  :root {
    --black: #000;
    --blue: #0040dd;
    --gray: #545456;
    --white: #fff;
  }

  body {
    background: var(--white);
    font-family: Arial, Helvetica, sans-serif;
  }

  table {
    color: var(--black);
    table-layout: fixed;
    width: 100%;
  }

  table,
  th,
  td {
    border: 1px solid var(--gray);
    border-collapse: collapse;
  }

  th {
    color: var(--black);
    letter-spacing: 1px;
  }

  td {
    padding: 10px;
    word-wrap: break-word;
  }

  td:first-child {
    color: var(--blue);
  }
  </style>
  </head>
  <body>
    <table>
      <thead>
        <tr>
        <% headers.each_with_index do |header, idx| %>
          <th>
            <%= header %>&nbsp;
            (<%= data.map { |col| col[idx] }.compact.size %>)
          </th>
        <% end %>
        </tr>
      </thead>

      <tbody>
        <% data.each do |row| %>
          <tr>
            <% row.each do |cell| %>
              <td>
                <% unless cell.nil? %>
                  <code><%= cell %></code>
                <% end %>
              </td>
            <% end %>
          </tr>
        <% end %>
      </tbody>
    </table>
  </body>
</html>
